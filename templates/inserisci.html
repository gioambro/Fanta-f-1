<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Inserisci Risultati</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container">
    <h1>Inserisci risultati</h1>
    <form action="/salva" method="post">
      {% for giocatore in giocatori %}
      <div class="card">
        <h2>{{ giocatore }}</h2>

        {% for i in range(1, 3) %}
        <div class="pilota-block">
          <h3>Pilota {{ i }}</h3>
          <label>Nome pilota:</label>
          <input type="text" name="{{ giocatore }}_pilota{{ i }}" required><br>

          <label>Griglia:</label>
          <input type="number" name="{{ giocatore }}_pilota{{ i }}_griglia" min="1" max="20"><br>

          <label>Posizione finale:</label>
          <input type="number" name="{{ giocatore }}_pilota{{ i }}_posizione" min="1" max="20"><br>

          <label>Gara Sprint?</label>
          <select name="{{ giocatore }}_pilota{{ i }}_sprint" onchange="toggleSprint(this)">
            <option value="no">No</option>
            <option value="si">Sì</option>
          </select><br>

          <div class="sprint-pos" style="display:none;">
            <label>Posizione Sprint:</label>
            <select name="{{ giocatore }}_pilota{{ i }}_sprint_pos">
              <option value="">--</option>
              {% for pos, pts in {1:8,2:7,3:6,4:5,5:4,6:3,7:2,8:1}.items() %}
              <option value="{{ pos }}">{{ pos }} ({{ pts }} pt)</option>
              {% endfor %}
            </select>
          </div>

          <details>
            <summary>Bonus</summary>
            <label>Pole (+2):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_pole"><option value="no">No</option><option value="si">Sì</option></select><br>
            <label>Fastest Lap (+1):</label>
            <input type="checkbox" name="{{ giocatore }}_pilota{{ i }}_fastest_lap"><br>
            <label>Driver of the Day (+1):</label>
            <input type="checkbox" name="{{ giocatore }}_pilota{{ i }}_driver_day"><br>
            <label>Fastest pit-stop (+2):</label>
            <input type="checkbox" name="{{ giocatore }}_pilota{{ i }}_fastest_pit"><br>
            <label>Rimonta (+2):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_rimonta"><option value="no">No</option><option value="si">Sì</option></select><br>
            <label>Posizioni guadagnate (+0,5):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_pos_guadagnate"><option value="no">No</option><option value="si">Sì</option></select><br>
            <label>Vittoria (+3):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_vittoria"><option value="no">No</option><option value="si">Sì</option></select><br>
            <label>Podio (+2):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_podio"><option value="no">No</option><option value="si">Sì</option></select><br>
          </details>

          <details>
            <summary>Malus</summary>
            <label>Squalifica (-5):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_squalifica"><option value="no">No</option><option value="si">Sì</option></select><br>
            <label>DNF (-3):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_dnf"><option value="no">No</option><option value="si">Sì</option></select><br>
            <label>Penalità ≥6s (-4):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_pen6"><option value="no">No</option><option value="si">Sì</option></select><br>
            <label>Penalità ≤5s (-3):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_pen5"><option value="no">No</option><option value="si">Sì</option></select><br>
            <label>Ultimo (-2):</label>
            <input type="checkbox" name="{{ giocatore }}_pilota{{ i }}_last_place"><br>
            <label>Non supera Q1 (-1):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_q1"><option value="no">No</option><option value="si">Sì</option></select><br>
            <label>Posizioni perse (-0,5):</label>
            <select name="{{ giocatore }}_pilota{{ i }}_pos_perse"><option value="no">No</option><option value="si">Sì</option></select><br>
          </details>
        </div>
        {% endfor %}
      </div>
      {% endfor %}
      <button type="submit">Salva tutti i risultati</button>
    </form>
  </div>

  <script>
  function toggleSprint(select) {
    let sprintDiv = select.parentElement.querySelector(".sprint-pos");
    sprintDiv.style.display = (select.value === "si") ? "block" : "none";
  }
  </script>
</body>
</html>
